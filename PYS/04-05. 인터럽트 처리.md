# 05 [심화학습] 인터럽트 처리

## 1 인터럽트의 개념
- 운영체제는 입출력 시 인터럽트를 이용하여 __시스템의 효율을 높임__
- 인터럽트 처리는 입출력뿐 아니라 __시스템을 보호__ 하는 데 매우 중요한 작업
#### 초기의 프로그래밍
- 프로그램을 위에서부터 한 줄씩 차례로 실행하는 순차적 프로그래밍
- 버튼이 눌렸는지 안 눌렸는지 주기적으로 직접 확인 = 비효율적
#### 오늘날의 프로그래밍
- 버튼이 눌리면 프로세스에 알려주는 __이벤트 드리븐__ 사용

### 운영체제에서의 입출력 처리
#### 폴링
- 과거 입출력을 요청하면 운영체제가 주기적으로 입출력장치를 직접 확인해서 처리
#### 인터럽트
- 이벤트 드리븐 방식과 마찬가지로 입출력을 요청하고 입출력이 완료되면 이벤트를 발생시켜 이 사실을 알림
- 인터럽트는 입출력에 국한된 개념이 아니라 종류가 많고 매우 광범위하게 쓰임

## 2 동기적 인터럽트와 비동기적 인터럽트
#### 동기적 인터럽트 (사용자 인터럽트)
- 프로세스가 실행 중인 명령어로 인해 발생
- 종류
    - 프로그램상의 문제 때문에 발생하는 인터럽트
    - 컴퓨터 작업자가 의도적으로 프로세스를 중단하기 위해 발생시킨 인터럽트
    - 입출력장치 같은 주변장치의 조작에 의한 인터럽트
    - 산술 연산 중 발생하는 인터럽트
#### 비동기적 인터럽트
- 실행 중인 명령어와 무관하게 발생
- 하드웨어적인 오류로 발생하는 인터럽트

## 3 인터럽트 처리 과정
- 인터럽트는 인터럽트 번호와 그 번호에 붙어 있는 함수의 쌍으로 이루어져 있음
#### 인터럽트 벡터
- 동시에 발생하는 인터럽트를 하나로 묶어서 처리하는 개념, 인터럽트의 집합
- 인터럽트와 인터럽트 핸들러를 일대일로 연결한 자료구조
#### 인터럽트 핸들러
- 인터럽트 처리를 위해 미리 정의된 함수
### 인터럽트 처리 과정
1. 인터럽트가 발생하면 현재 실행 중인 프로세스는 일시 정지 상태가 되며, 재시작하기 위해 현재 프로세스 관련 정보를 임시로 저장한다.
2. 인터럽트 컨트롤러가 실행되어 인터럽트의 처리 순서를 결정한다. 이때 여러 개의 인터럽트가 동시에 발생했다면 인터럽트의 우선순위를 고려하여 중요한 인터럽트부터 처리하도록 순서를 결정한다.
3. 먼저 처리할 인터럽트가 결정되면 인터럽트 벡터에 등록된 인터럽트 핸들러가 실행된다.
4. 인터럽트 벡터에 연결된 핸들러가 인터럽트 처리를 마치면 일시 정지된 프로세스가 다시 실행되거나 종료된다. 발생한 인터럽트가 입출력 완료 같은 경우이면 일시 정지된 프로세스가 다시 실행되고, 다른 프로세스의 메모리 영역 침범이나 오류 같은 경우이면 종료된다.

## 4 인터럽트와 이중 모드
#### 커널 모드
- 운영체제와 관련된 커널 프로세스가 실행되는 상태
#### 사용자 모드
- 사용자 프로세스가 실행되는 상태
#### 이중 모드
- 사용자 프로세스가 시스템 자원에 직접 접근하면 문제가 발생할 수 있기 떄문에 사용자 프로세스가 커널의 기능을 사용하려면 __시스템 호출__ 을 이용하여 커널 프로세스에 작업을 요청해야 함
- 사용자 프로세스는 시스템 호출을 요청한 후 대기 상태로 전환되고 커널 프로세스는 요청받은 작업을 처리함 = 사용자 모드에서 커널 모드로 전환
- 이와 같이 __운영체제가 두 모드를 전환하며 일 처리를 하는 것__ 을 이중 모드라고 함
- 사용자는 1. 시스템 호출을 사용한 경우(자발적), 2. 인터럽트를 발생시킨 경우(비자발적) 커널 모드로 진입할 수 있음