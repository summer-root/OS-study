# 교착 상태 해결 방법
## 교착 상태 해결 방법
- 교착 상태 예방 : 교착상태는 상호 배제, 비선점, 점유와 대기, 원형 대기라는 네가지 조건을 동시에 충족해야 발생하기 때문에 이 중 하나라도 무력화 되면 교착상태가 발생하지 않는다. 실효성이 적어 잘 사용되지 않는다.
- 교착 상태 회피 : 자원을 할당하다가 교착 상태를 유발할 가능성이 있다고 판단되면 자원 할당을 중단하고 지켜본다. 자원을 얼마만큼 할당해야 교착상태가 발생하지 않는다는 보장이 없기때문에 실효성이 적다.
- 교착 상태 검출 : 자원 할당 그래프를 사용하여 교착상태를 발견. 교착상태 발생시 교착 상태 회복단계가 실행된다.
- 교착 상태 회복 : 교착 상태를 검출한 후 해결하는 현실적인 접근 방법이다

------------

## 교착 상태 예방
### 상호 배제 예방
시스템 내에 있는 상호 배타적인 모든 자원, 즉 독점적으로 사용할 수 있는 자원을 없애버려 교착상태가 발생하지 않도록 한다.<br>
그러나 현실적으로는 모든 자원을 공유할 수 없으며 상호 배제를 적용하여 보호해야 하는 자원이 있다. 또한 시스템 내에는 공유할 수 없는 자원이 있다.<br>
따라서 상호 배제를 무력화 하는것은 사실상 어렵다.<br>

### 비선점 예방
모든 자원을 빼앗을수 있도록 만드는 방법이다. <br>
식사하는 철학자 문제에서 옆 사람의 포크를 빼앗을수 있다면 교착상태가 발생하지 않지만, 임계구역을 보호하기 위해 잠금을 사용하면 자원을 빼앗을수 없을 뿐만 아니라 상호배제도 보장할 수 없다. <br>
따라서 시스템의 모드 자원을 빼앗을수 있도록 하기 어려우며 빼앗을수 있더라도 어떤 기준으로 빼앗을지, 빼앗을 시간 중 얼마나 사용할지 결정하기 어렵다.<br>
또한 아사현상을 일으킨다는 문제가 있다. <br>
아사현상은 주로 에이징을 사용하여 해결하지만 우선수위가 낮은 프로세스가 몇 번을 양보한 끝에 무조건 자원을 사용한다고 가정하면 이 프로세스가 점유하고 있는 자원은 비선점 자원이되어 다시 교착상태에 빠질수 있기때문에 에이징을 사용하기 어렵고 비선점 조건을 무력화하기 어렵다.<br>

### 점유와 대기 예방
프로세스가 자원을 점유한 상태에서 다른 자원을 기다리지 못하게 하는 방법으로 "전부 할당하거나 아니면 아예 할당하지 않는" 방식을 적용하는것이다.<br>
이를 위해 프로세스는 시작 초기에 자신이 사용하려는 모든 자원을 한꺼번에 점유하거나, 그렇지 못할 경우 자원을 모두 할당해야 한다.<br>
이 방법은 식사하는 철학자 문제에서 왼쪽 포크를 잡은 상태에서 오른쪽 포크를 잡지 못하도록 막는것과 같은데, 철학자들은 식사를 시작할때 양손에 포크를 잡아야 하며 그렇게 할 수 없으면 잡았던 포크를 내려놓아야 한다.<br>
따라서 동작이 빠른 철학자가 먼저 식사를 할 수 있다.<br>

점유와 대기 예방은 다음과 같은 단점이 있다.<br>
- 프로세스가 자신이 사용하는 모든 자원을 자세히 알기 어렵다.
- 자원의 활용성이 떨어진다.
- 많은 자원을 사용하는 프로세스가 적은 자원을 사용하는 프로세스보다 불리하다.
- 결국 일괄 작업 방식으로 동작한다.
 
### 원형 대기 예방
점유와 대기를 하는 프로세스들이 원형을 이루지 못하도록 막는 방법이다. <br>
자원을 한 방향으로만 사용하도록 설정함으로써 원형 대기를 예방할 수 있다. 즉 모든 자원에 숫자를 부여하고 숫자가 큰 방향으로만 자원을 할당하는것이다.<br>
원형 대기 예방의 경우 프로세스들이 자원을 사용하려고 할때 작은 번호의 자원을 할당 받은 후 큰 번호의 자원을 할당받도록 한다.<br>
<br>
원형 대기 예방은 모든 자원을 할당받아야 실행할 수 있는 점유와 대기 예방보다 완화된 방법이지만 단점이 있다.<br>
- 프로세스 작업 진행에 유연성이 떨어진다.
- 자원의 번호를 어떻게 부여할 것인지가 문제이다.

## 교착 상태 회피
### 교착 상태 회피의 개념
교착 상태 회피는 프로세스에 자원을 할당할 때 어느 수준 이상의 자원을 나누어주면 교착상태가 발생하는지 파악하여 그 수준 이하로 자원을 나누어주는 방법이다. <br>
교착상태가 발생하지 않는 범위 내에서만 자원을 할당하고, 교착상태가 발생하는 범위에 있으면 프로세스를 대기시키다.<br>
<br>
교착상태 회피는 할당되는 자원의 수를 조절하여 교착상태를 피한다. 이느 시스템의 운영방식에 변경을 가하지 않기때문에 교착 상태 예방보다 좀 더 유연하다<br>
교착상태 회피는 자원의 총스와 현재 할당된 자원의 수를 기준으로 시스템을 안정상태와 불안정 상태로 나누고 시스템이 안정상태를 유지하도록 자원을 할당하다.<br>
하지만 불안정 상태에서 항상 교착상태가 발생하는것은 아니며 교착상태가 발생할 가능성이 높아진다.<br>

### 은행원 알고리즘
교착상태 회피를 구현하는 방법중 하나이다. <br>
대출금액이 대출 가능한 범위내이면(안정상태이면) 허용되지만 그렇지 않으면 거부되는것과 유사하기때문에 이렇게 불리게 되었다. <br>
<br>
다음은 은행원 알고리즘의 변수이다.<br>
- 전체 자원 : 시스템 내 전체 자원의 수
- 가용 자원 : 시스템 ㄴ내 혀재 사용할 수 있는 자원의 수(가용자원=전체자원-모든 프로세스의 할당 자원)
- 최대 자원 : 각 프로세스가 선언된 최대 자원의 수
- 할당 자원 : 각 프로세스에 현재 할당된 자원의 수
- 기대 자원 : 각 프로세스가 앞으로 사용할 자원의수(기대자원=최대자원-할당자원)












