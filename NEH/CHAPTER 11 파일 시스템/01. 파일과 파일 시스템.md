# 파일과 파일 시스템

## 파일 시스템의 개요

### 파일 시스템의 개념

운영체제는 파일을 보관하고 관리하는 파일 관리자를 두어 저장장치의 전체 관리를 맡기는데 이를 파일 시스템이라고 한다. 

파일 관리자는 사용자의 요청에 따라 파일을 저장하거나 파일의 내용을 읽어온다. 파일 관리자는 파일 테이블을 이용하여 파일을 관리하며 파일의 생성, 수정, 삭제 등을 수행한다. 또한 사용자가 파일을 사용하고자 할 때 읽기, 쓰기, 실행과 같은 다양한 접근 방법을 제공한다.

사용자가 특정 파일에 접근하려면 파일 관리자로부터 파일에 접근할 수 있는 권한(키)를 획득해야 하는데 파일 접근 권한을 파일 디스크립터라고 한다.

<br>



### 파일 시스템의 기능

| 기능           | 설명                                                         |
| -------------- | ------------------------------------------------------------ |
| 파일 구성      | 사용자의 요구에 따라 파일과 디렉터리를 만든다.               |
| 파일 관리      | 파일 생성, 수정, 삭제 등의 관리를 하고 수시로 조각모음을 하여 사용자가 파일에 빨리 접근할 수 있도록 한다. |
| 접근 권한 관리 | 다른 사용자로부터 파일을 보호하기 위해 접근 권한을 관리한다. |
| 접근 방법 제공 | 파일을 읽고 쓰고 실행할 수 있도록 사용자에게 접근 방법을 제공한다. |
| 무결성 보장    | 파일의 내용이 손상되지 않도록 무결성을 보장한다.             |
| 백업과 복구    | 사고로부터 파일을 보호하기 위해 백업과 복구 작업을 한다.     |
| 암호화         | 파일을 암호화하여 악의적인 접근으로부터 파일을 보호한다.     |

<br>



### 블록과 파일 테이블

데이터는 운영체제와 저장장치 간에 블록 단위로 전송된다. 한 블록에는 주소 하나가 할당된다. 

블록의 크기는 시스템마다 다르다. 블록 크기를 작게 설정하면 내부 단편화 현상이 줄어들어 저장장치를 효율적으로 쓸 수 있지만 입출력 속도가 느려진다. 따라서 큰 파일을 많이 사용할 때는 블록 크기를 크게 잡는 것이 좋다.

<br>



## 파일 분류와 확장자

파일은 논리적인 데이터의 집합으로 0과 1의 비트 패턴으로 이루어지며 실행 파일과 데이터 파일로 나뉜다.

- 실행 파일: 사용자의 요청으로 프로세스가 된 파일
- 데이터 파일: 실행 파일이 작업하는 데 필요한 데이터를 모아 놓은 파일

<br>



확장자는 파일의 성격을 알려준다. 전세계적으로 표준을 정하여 사용하지만 제작자가 필요에 따라 새로 만들어 사용할 수 있다.

유닉스에는 실행 파일 확장자가 없다.

| 파일        | 파일 종류       | 확장자                    |
| ----------- | --------------- | ------------------------- |
| 실행 파일   | 실행 파일       | exe, com                  |
| 데이터 파일 | 소스코드 파일   | c, cpp, pas, a, java      |
|             | 라이브러리 파일 | lib, a, dll               |
|             | 배치 파일       | bat, sh, csh              |
|             | 문서 파일       | txt, doc, hwp, pdf, ps 등 |
|             | 동영상 파일     | avi, asf, mkv, mov, rmv   |
|             | 음악 파일       | wav, mp3, ogg, flc, acc   |
|             | 이미지 파일     | bmp, gif, jpg, tiff, png  |
|             | 압축 파일       | rar, zip, zrc, al         |

<br>



## 파일 이름과 연결 프로그램

대부분의 파일 이름은 파일 이름.확장자 형태로 구성된다. 파일 이름 관련 유의 사항은 다음과 같다.

- 파일 확장자는 3자 이하가 대부분이다.
- 파일 이름에는 마침표를 여러 개 사용할 수 있는데, 이때는 마지막 마침표 다음 글자를 확장자로 인식한다.
- 파일 이름은 경로 이름을 포함하여 최대 255자로 할 수 있다.
- 파일 이름에는 영문자, 숫자, -, _, .를 주로 사용한다. 윈도우에서는 특정 특수 문자를 사용할 수 있고 대문자와 소문자를 구분하지 않는다. 유닉스에서는 대부분의 특수 문자를 사용할 수 없고 대문자와 소문자를 구분한다.

<br>



윈도우에서 데이터 파일을 더블 클릭하면 해당 파일을 사용하는 응용 프로그램이 실행된다. 이를 연결 프로그램이라고 한다.

<br>



## 파일 속성

| 속성          | 특징                                                         |
| ------------- | ------------------------------------------------------------ |
| name          | 확장자를 포함한 전체 파일의 이름                             |
| type          | 확장자로 구분되는 파일의 종류                                |
| size          | 파일 용량                                                    |
| time          | 파일의 접근 시간으로 만든 시간, 변경 시간, 최근 파일을 열어본 시간 등을 세분됨 |
| location      | 파일의 위치                                                  |
| accessibility | 파일의 접근 권한                                             |
| owner         | 파일의 소유자                                                |

<br>



- 파일 헤더: 파일 테이블에서 관리하며 파일의 이름, 종류, 크기, 시간, 접근 권한 등과 같은 일반적인 내용이 담겨 있다.

- 고유 헤더: 데이터 파일에는 응용 프로그램이 필요로 하는 고유 헤더가 달려 있다. 고유 헤더에는 파일의 버전 번호, 크기, 특수 정보 등 응용 프로그램이 필요로 하는 정보가 담겨 있다.

  고유 헤더는 파일 복구 시 유용하게 사용된다.

<br>



## 파일 작업의 유형

파일을 변경하는 것을 파일 작업 또는 파일 연산이라고 한다.

<br>



### 파일 자체를 변경하는 작업

- open, close

  파일을 열거나 닫음

- create

  파일 생성

- remove, copy, rename

  파일 이동, 파일 복사, 파일 이름 변경

- list

  디렉터리에 있는 파일의 정보 출력

- search

  파일 검색

<br>



### 파일 내용을 변경하는 작업

프로세스 입장에서 수행하는 것으로 주로 함수 형태이다.

| 작업     | 설명                    | 작업     | 설명                           |
| -------- | ----------------------- | -------- | ------------------------------ |
| open()   | 파일을 연다.            | write()  | 파일에 새로운 내용을 쓴다.     |
| create() | 새로운 파일을 생성한다. | update() | 파일 내용 중 일부를 변경한다.  |
| close()  | 파일을 닫는다.          | insert() | 파일에 새로운 내용을 추가한다. |
| read()   | 파일 내용을 읽는다.     | delete() | 파일 내용 중 일부를 지운다.    |

<br>



## 파일 구조

### 순차 파일 구조

일반 파일은 기본적으로 순차 파일 구조이다. 파일 내용이 하나의 긴 줄로 늘어선 형태이다. 

장점

- 모든 데이터가 순서대로 기록되기 때문에 저장 공간에 낭비되는 부분이 없다.
- 구조가 단순하여 테이프, 플로피디스크, 메모리를 이용한 저장장치에 모두 적용할 수 있다.
- 순서대로 데이터를 읽거나 저장할 때 매우 빠르게 처리된다.

단점

- 파일에 새로운 데이터를 삽입/삭제할 때 시간이 많이 걸린다. 중간에 데이터를 삽입하려면 데이터를 뒤로 밀어 빈 공간을 만들어야 하고, 중간에 데이터를 삭제한 경우에는 그 뒤에 있는 데이터를 앞으로 당겨야 한다. 따라서 데이터의 변경이 잦은 경우 적당하지 않다.
- 특정 데이터로 이동할 때 직접 접근이 어렵다. 데이터 검색에 적합하지 않다.

<br>



### 인덱스 파일 구조

순차 파일 구조에 인덱스 테이블을 추가하여 순차 접근과 직접 접근이 가능하다.

인덱스를 이용한 방식을 인덱스 숱차 접근이라고 하며 이렇게 구성된 파일을 ISAM 파일이라고 한다.

인덱스 테이블을 여러 개 만들면 다양한 접근이 가능하다. 데이터베이스와 같이 데이터의 빠른 접근이 필요한 시스템에 사용된다.

<br>



### 직접 파일 구조

저장하려는 데이터의 특정 값에 어떤 관계를 정의하여 물리적인 주소로 바로 변환하는 파일 구조이다.

특정 함수를 이용하여 직접 접근할 수 있도록 하며 이때 사용하는 함수를 해시 함수라고 한다. 

장점

- 데이터 접근이 매우 빠름

단점

- 전체 데이터가 고르게 저장될 수 있는 해시 함수를 찾아야 함