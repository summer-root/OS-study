# 프로세스 제어 블록과 문맥 교환

## 프로세스 제어 블록

프로세스 제어 블록은 프로세스를 실행하는 데 필요한 중요 정보를 보관하는 자료구조로 TCB(Task Control Block)라고도 한다. 모든 프로세스는 고유의 프로세스 제어 블록을 가진다.

<br>



### 프로세스 제어 블록의 구성

- 포인터 : 프로세스 제어 블록의 첫 번째 블록에 저장된다. 프로세스 제어 블록을 연결하여 준비 상태나 대기 상태의 큐를 규현할 때 사용한다.
- 프로세스 상태 : 프로세스가 현재 어떤 상태에 있는지 나타내며 프로세스 제어 블록의 두 번째 블록에 저장된다.
- 프로세스 구분다 : 다른 프로세스와 구분하기 위한 구분자를 저장한다.
- 프로그램 카운터 : 다음에 실행될 명령어의 위치를 가리키는 프로그램 카운터의 값을 저장한다.
- 프로세스 우선순위 : 프로세스의 중요도는 각각 다르다. 사용자 프로세스보다 커널 프로세스가 우선순위가 높고, 사용자 프로세스 사이에서도 우선순위가 다르다. 
  다양한 우선순위의 프로세스가 대기 상태로 들어오기 때문에 대기 상태의 큐도 우선순위별로 따로 운영된다. 따라서 우선순위에 따라 프로세스 제어 블록들이 여러 줄로 서 있게 된다. CPU 스케줄러가 준비 상태에 있는 프로세스 중 실행 상태로 옮겨야 할 프로세스를 선택할 때는 프로세스 우선순위를 기준으로 삼는다. 높은 우선순위의 프로세스가 낮은 우선순위의 프로세스보다 먼저 실행되고 더 자주 실행된다.
- 각종 레지스터 정보 : 프로세스가 실행되는 중에 사용하던 레지스터 값이 저장된다. 
- 메모리 관리 정보 : 메모리 위치 정보, 메모리 보호를 위해 사용하는 경계 레지스터 값, 한계 레지스터 값 등이 저장된다. 그 외에 세그먼테이션 테이블, 페이지 테이블 등의 정보도 보관한다.
- 할당된 자원 정보 : 프로세스를 실행하기 위해 사용하는 입출력 자원이나 오픈 파일 등에 대한 정보를 말한다.
- 계정 정보 : 계정 번호, CPU 할당 시간, CPU 사용 시간 등의 정보를 말한다.
- 부모 프로세스 구분자와 자식 프로세스 구분자 : 프로세스 제어 블록에는 부모 프로세스를 가리키는 PPID와 자식 프로세스를 가리키는 CPID의 정보도 저장된다.

<br>



## 문맥 교환

### 문맥 교환의 의미

문맥 교환은 CPU를 차지하던 프로세스가 나가고 새로운 프로세스를 받아들이는 작업을 말한다. 이때 두 프로세스 제어 블록의 내용이 변경된다. 실행 상태에서 나가는 프로세스 제어 블록에는 지금까지의 작업 내용을 저장하고, 실행 상태로 들어오는 프로세스 제어 블록의 내용으로 CPU가 다시 세팅된다. 이전 작업 상태가 되어야 다음 작업을 할 수 있기 때문이다. 이와 같이 두 프로세스의 프로세스 제어 블록을 교환하는 작업이 문맥 교환이다.

<br>



### 문맥 교환의 절차

문맥 교환이 일어나는 경우는 매우 다양하다. 일반적으로 한 프로세스가 자신에게 주어진 시간을 다 사용하면 발생하고, 인터럽트가 걸렸을 때도 발생한다. 