# 메모리 주소

##  32bit CPU와 64bit CPU의 차이

CPU의 비트는 한 번에 다룰 수 있는 데이터의 최대 크기를 의미한다. CPU 내부 부품은 모두 이 비트를 기준으로 제작된다. 따라서 32bit  CPU 내의 레지스터 크기는 전부 32bit이고, 산술 논리 연산 장치도 32bit를 처리할 수 있도록 설계된다. 또한 데이터를 전송하는 각종 버스의 대역폭도 32bit이다.

32bit CPU의 경우 메모리 주소를 지정하는 레지스터인 메모리 주소 레지스터의 크기가 32bit이므로 표혐할 수 있는 메모리 주소의 범위는 0~22^32 -1이며 총 개수는 22^32개이다. 이를 16진수로 나타내면 00000000~FFFFFFFF이며 총 크기는 약 4GB이다. 따라서 32bit CPU 컴퓨터는 메모리를 최대 4GB까지 사용할 수 있다. 64bit CPU의 메모리는 약 16777216TB의 메모리를 사용할 수 있다.

물리 주소 공간 : 하드웨어 입장에서 바라본 메모리의 주소 공간으로 컴퓨터마다 크기가 다르다.

논리 주소 공간 : 사용자 입장에서 바라본 주소 공간을 말한다.

<br>



## 절대 주소와 상대 주소

### 메모리 영역의 구분

단순 메모리 구조는 한 번에 한 가지 일만 처리하는 일괄 처리 시스템에서 볼 수 있는 구조로 메모리를 운영체제 영역과 사용자 영역으로 나누어 관리한다. 그러나 사용자 프로세스가 운영체제의 크기에 따라 적재되는 주소가 달라지는 것은 번거로운 일이기 때문에 이를 개선하여 사용자 프로세스를 메모리의 최상위부터 사용할 수 있다. 즉, 메모리의 최상위부터 운영체제 방향으로 내려오면서 사용하는 것이다. 이 방법은 운영체제의 크기에 관계없이 사용자 영역의 시작점을 결정할 수 있으나 메모리를 거꾸로 사용하기 위해 주소를 변경하는 일이 복잡하기 때문에 잘 쓰이지 않는다. 

CPU 내에 있는 경계 레지스터는 사용자 영역이 운영체제 영역을 침범하는 것을 막는 역할을 한다. 경계 레지스터는 운영체제 영역과 사용자 영역의 경계 지점 주소를 가진 레지스터이다. 메모리 관리자는 사용자가 작업을 요청할 때마다 경계 레지스처의 값을 벗어나는지 검사하고, 만약 벗어나는 작업을 요청하는 프로세스가 있는 경우 그 프로세스를 종료한다.

<br>



### 절대 주소와 상대 주소의 개념

절대 주소 : 실제 물리 주소를 가리키며 메모리 관리자 입장에서 바라본 주소이다. 즉 메모리 주소 레지스터가 사용하는 주소로 컴퓨터에 꽂힌 렘 메모리의 실제 주소를 말한다.

상대 주소 : 사용자 프로세스 입장에서 바라본 주소이며 절대 주소와 관계없이 항상 0번지부터 시작한다. 이를 논리 주소 공간이라고 부른다, 상대 주소를 사용하면 프로세스 입장에서 상대 주소가 사용할 수 없는 영역의 위치를 알 필요가 없고 주소가 항상 0번지부터 시작하기 때문에 편리하다.

메모리 관리자는 절대 주소를 사용하지만 사용자 입장에서 절대 주소를 사용하면 매번 운영체제 영역을 확인해야 하기 때문에 불편하고 위험하다. 또한 운영체제 영역의 주소가 사용자에게 노출되면 실수나 고의적 조작으로 운영체제 영역을 침범할 수 있다.

<br>



### 상대 주소를 절대 주소로 변환하는 과정

메모리 관리자가 상대 주소를 절대 주소로 변환하는 과정은 다음과 같다.

1. 사용자 프로세스가 상대 주소를 사용하여 메모리에 접근한다.
2. CPU는 메모리 관리자에게 해당하는 상대 주소에 있는 내용을 가져오라고 명령한다.
3. 메모리 관리자는 상대 주소 값에 재배치 레지스터 값을 더하여 절대 주소를 구한다. 

** 재배치 레지스터 : 주소 변환의 기본이 되는 주소값을 가진 레지스터로 메모리에서 사용자 영역의 시작 주소값이 저장된다.
