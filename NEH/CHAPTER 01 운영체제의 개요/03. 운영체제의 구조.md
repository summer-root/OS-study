# 운영체제의 구조

## 커널과 인터페이스

운영체제는 크게 커널과 인터페이스 두 부분으로 분리되며, 같은 커널을 사용하더라도 다른 인터페이스를 가진 형태로 제작할 수 있다.

예를 들어 유닉스의 경우 사용자 인터페이스로 셸(shell)을 제공한다. 셸에는 C셸, T셸, 배시셸 등이 존재하며, CLI 방식이기 떄문에 일반인이 사용하기 어렵다. 하지만, GUI 방식의 인터페이스를 제공하는 Mac OS X도 유닉스 계열의 커널을 이용해서 만들어졌다. 이처럼 같은 커널이어도 다른 인터페이스가 장착되면 사용자에게는 다른 운영체제처럼 보인다.

<br>



### 커널 (Kernel)

프로세스 관리, 메모리 관리, 저장 장치 관리와 샅은 운영체제의 핵심적인 기능을 모아놓은 것을 말하며, 운영체제의 성능을 좌우한다.

<br>

### 인터페이스 (Interface)

커널에 사용자의 명령을 전달하고 실행 결과를 사용자에게 알려 주는 역할을 한다.

<br>


## 시스템 호출과 디바이스 드라이버

### 시스템 호출

시스템 호출이란 커널이 스스로를 보호하기 위해 만든 인터페이스이다. 커널은 사용자나 응용프로그램으로부터 컴퓨터 자원을 보호하기 위해 자원에 직접 접근하는 것을 차단한다. 따라서 자원을 이용해야 하는 경우에는 시스템 인터페이스를 이용하여 접근하여야 한다.

시스템 호출은 커널이 제공하는 시스템 관련 서비스를 모아 놓은 것이며, 함수 형태로 제공된다. C 언어의 printf() 함수도 시스템 호출 중 하나이다.

시스템 호출을 이용하여 자원을 요청하면 데이터가 어느 위치에 저장되는지 등 자원에 위협이 되는 정보를 사용자나 응용프로그램이 알 수 없다. 또한 시스템 호출을 이용하면 커널이 데이터를 가져오거나 저장하는 것을 전적으로 책임지기 떄문에 컴퓨터 자원을 관리하기가 수월하다.

<br>

#### :pencil2: API와 SDK

- API(Application Programming Interface; 응용 프로그램 인터페이스) : 응용 프로그램이 자신과 연관된 프로그램을 만들 수 있도록 제공하는 인터페이스이다. 시스템 호출보다 광범위한 개념이다.
- SDK(System Developer's Kit; 시스템 개발자용 키트) : 프로그램 개발자를 위해 API, API 사용 매뉴얼, 프로그램 개발에 필요한 코드 편집기, 에뮬레이터 등 개발용 프로그램을 하나로 묶어 배포하는 개발 툴을 의미한다.

<br>



### 드라이버

커널과 하드웨어의 인터페이스를 담당한다. 운영체제가 여러 하드웨어를 모두 사용할 수 있는 환경을 제공하기 위해서는 각 하드웨어에 맞는 프로그램을 직접 개발하여야 한다. 그러나 커널이 모든 하드웨어에 맞는 인터페이스를 개발하는 것은 어렵기 때문에 드라이버가 그 역할을 대신한다. 커널은 입출력의 기본적인 부분만 제작하고, 하드웨어의 특성을 반영한 소프트웨어를 받아 커널이 실행될 때 함께 실행되도록 한다. 

마우스, 키보드와 같이 복잡하지 않은 디바이스 드라이버는 커널에 포함되나, 복잡한 드라이버의 경우 사용자가 직접 드라이버를 설치하여야 한다.

<br>



## 커널의 구성

### 커널이 하는 일

- 프로세스 관리 : 프로세스에 CPU를 배분하고 작업에 필요한 제반 환경을 제공한다.
- 메모리 관리 : 프로세스에 작업 공간을 배치하고 실제 메모리보다 큰 가상 공간을 제공한다.
- 파일 시스템 관리 : 데이터를 저장하고 접근할 수 있는 인터페이스를 제공한다.
- 입출력 관리 : 필요한 입력과 출력 서비스를 제공한다.
- 프로세스 간 통신 관리 : 공동 작업을 위한 각 프로세스 간 통신 환경을 제공한다.

<br>

### 커널의 분류

커널의 핵심 기능을 어떻게 구현하는가에 따라 구분된다.

<br>



#### 단일형 구조(monolithic architecture) 커널 

초창기의 운영체제 구조로, 커널의 핵심 기능을 구현하는 모듈들이 구분 없이 하나로 구성되어 있다. 대표적으로 MS-DOS, VMS, 초기의 유닉스가 단일형 구조 커널이다.

![단일형 구조 커널](https://github.com/summer-root/OS-study/blob/main/NEH/CHAPTER%2001%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%EC%9D%98%20%EA%B0%9C%EC%9A%94/%EC%82%AC%EC%A7%84%20%EC%B2%A8%EB%B6%80/%EB%8B%A8%EC%9D%BC%ED%98%95%20%EA%B5%AC%EC%A1%B0%20%EC%BB%A4%EB%84%90.jpg)

- 장점 : 모듈이 거의 분리되지 않았기 때문에 모듈 간의 통신 비용이 줄어 효율적인 운영이 가능하다. 
- 단점 
  - 모든 모듈이 하나로 묶여 있기 때문에 버그나 오류를 처리하기 어렵다.
  - 운영체제의 여러 기능이 서로 연결되어 있어 기능상의 결함이 시스템 전체로 확산될 수 있다.
  - 이식성이 낮다.
  - 크고 복잡한 운영체제에 적용하기 어렵다.

<br>



#### 계층형 구조(layered architecture) 커널

단일형 구조 커널이 발전된 형태로 비슷란 기능을 가진 모듈을 묶어 하나의 계층으로 만들고 , 계층 간의 통신으 통해 운영체제를 구현하는 방식이다. 단일형 구조보다 버그나 오류를 쉽게 처리할 수 있다.

![계층형 구조 커널](https://github.com/summer-root/OS-study/blob/main/NEH/CHAPTER%2001%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%EC%9D%98%20%EA%B0%9C%EC%9A%94/%EC%82%AC%EC%A7%84%20%EC%B2%A8%EB%B6%80/%EA%B3%84%EC%B8%B5%ED%98%95%20%EA%B5%AC%EC%A1%B0%20%EC%BB%A4%EB%84%90.jpg)

<br>

#### 마이크로 구조(micro architecture) 커널

계층형 구조의 접근 방식과 반대로 개발되었다. 마이크로 구조 커널의 운영체제는 프로세스 관리, 메모리 관리, 프로세스 간 통신 관리 등 가장 기본적인 기능만 제공한다. 따라서 다른 커널에 비해 운영체제의 많은 부분이 사용자 영역에 구현되어 있다.

커널은 메모리 관리와 프로세스 간의 동기화 서비스를 제공하며, 메모리 관리자와 동기화 모듈은 통신 모듈로 연결되어 있다. 그러므로 각 모듈은 세분화되어 존재하고, 모듈 간의 정보 교환은 프로세스 간 통신을 이용하여 이루어진다.

각 모듈은 독립적으로 작동하기 때문에 하나의 모듈이 실패하더라도 전체 운영체제가 멈추지 않는다. 많은 컴퓨터에 이식하기 쉽고 커널이 가벼워 CPUI 용량이 작은 시스템에도 적용 가능하다.

![마이크로 구조 커널](https://github.com/summer-root/OS-study/blob/main/NEH/CHAPTER%2001%20%EC%9A%B4%EC%98%81%EC%B2%B4%EC%A0%9C%EC%9D%98%20%EA%B0%9C%EC%9A%94/%EC%82%AC%EC%A7%84%20%EC%B2%A8%EB%B6%80/%EB%A7%88%EC%9D%B4%ED%81%AC%EB%A1%9C%20%EA%B5%AC%EC%A1%B0%20%EC%BB%A4%EB%84%90.jpg)

<br>



## 가상머신

가상머신이란 운영체제와 응용 프로그램 사이에서 작동하는 프로그램으로, 가상머신을 설치하면 응용 프로그램이 모두 동일한 환경에서 작동하는 것처럼 보이게 된다. 여러 운영체제를 하나의 컴퓨터에서 사용하고 싶은 경우에 가상머신을 사용할 수 있다. 단, 응용프로그램이 가상머신을 통해서만 작동되므로 느려진다는 단점이 있다.



C언어는 저급 언어이기 때문에 시스템 프로그래밍 언어로 적합하다. 이러한 C언어로 만든 운영체제가 바로 유닉스이다. 하지만 큰 단점은 유닉스와 다른 커널을 가진 운영체제와 호환성이 떨어진다는 것이다. 따라서 다른 운영체제에서 사용하기 위해서는 소스코드를 수정하여야 한다. 

이 호환성 문제를 해결한 언어가 바로 자바이다. 자바는 운영체제 위에 가상머신을 만들고 그 위에서 응용프로그램이 작동하게 하기 떄문에 다른 운영체제에서도 소스 코드 수정 없이 사용 가능하다. 자바에서 사용되는 가상머신을 JVM(Java Virtual Machine)이라고 한다.

 





