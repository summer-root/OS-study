# 인터럽트 처리

## 인터럽트의 개념

인터럽트는 CPU가 프로그램을 실행하고 있을 떄 예외 상황이 발생하여 처리가 필요한 경우 사용하는 기능으로 시스템을 보호하는 데 매우 중요한 작업이다.

컴퓨터 사용 초기 프로그래밍 방식은 프로그램을 위에서부터 한 줄씩 차례로 실행하는 순차적 프로그래밍이었다. 순차적 프로그래밍은 버튼이 존재할 떄 해당 버튼이 눌렸는지 안 눌렸는지 주기적으로 직접 확인한다. 이러한 방식은 비효율적이다. 오늘날의 프로그래밍에서는 버튼이 눌리면 프로세스에게 알려 주는데 이를 이벤트 드리븐이라고 한다.

운영체제의 입출력 처리도 이와 같다. 과거에는 입출력을 요청하면 운영체제가 주기적으로 입출력장치를 직접 확인해서 처리했는데 이러한 방식을 폴링이라고 한다. 하지만 입출력 장치가 많아지면서 운영체제가 모든 입출력을 관리하기 어려워지자 이벤트 드리븐처럼 입출력이 완료되면 이벤트를 발생시켜 해당 사실을 알리게 되었는데 이를 인터럽트라고 한다.

인터럽트는 입출력에만 국한된 개념은 아니다.

<br>



## 동기적 인터럽트와 비동기적 인터럽트

동기적 인터럽트 : 실행 중인 명령어로 인해 발생하는 인터럽트로 사용자 인터럽트라고도 한다.

- 프로그램 상의 문제 때문에 발생하는 인터럽트
- 컴퓨터 작업자가 의도적으로 프로세스를 중단하기 위해 발생시킨 인터럽트
- 입출력장치 같은 주변장치의 조작에 의한 인터럽트
- 산술 연산 중 발생하는 인터럽트

<br>

비동기적 인터럽트 : 실행 중인 명령어와는 무관하게 발생하는 인터럽트로 하드디스크 읽기 오류, 메모리 불량과 같은 하드웨어적인 오류로 발생한다.

- 키보드 인터럽트
- 마우스 인터럽트

<br>



## 인터럽트 처리 과정

인터럽트는 인터럽트 번호와 그 번호에 있는 함수의 쌍으로 이루어져 있다. 이때 함수는 해당 인터럽트가 발생한 경우 어떤 일을 할지 정의해 놓은 것이다. 인터럽트 번호는 각 인터럽트를 식별하는 고유 번호로 IRQ라고도 한다.

<br>



인터럽트 벡터 : 동시에 발생하는 인터럽트를 하나로 묶어 처리하는 개념으로 각 인터럽트를 처리하는 함수가 연결되어 있다. 해당 함수에 인터럽트가 발생하면 처리할 일이 정의되어 있고, 이를 인터럽트 핸들러라고 부른다.

<br>



인터럽트 처리 과정

1. 인터럽트 발생 시 현재 실행 중인 프로세스는 일시 정지 상태가 되고, 재시작하기 위해 현재 프로세스 관련 정보를 임시로 저장
2. 인터럽트 컨트롤러가 실행되어 인터럽트의 처리 순서 결정
3. 먼저 처리할 인터럽트가 결정되면 인터럽트 벡터에 등록된 인터럽트 핸들러가 실행됨
4. 인터럽트 처리를 마치면 일시 정지된 프로세스가 다시 실행되거나 종료됨

<br>



## 인터럽트와 이중 모드

운영체제가 사용자 모드와 커널 모드를 전환하며 일 처리를 하는 것을 이중 모드라고 한다. 이중 모드는 운영체제가 자원을 보호하기 위해 사용하는 기법으로 사용자 프로세스가 커널 모드에서 실행되지 못하도록 한다.

<br>



사용자가 커널 모드로 진입하는 경우

1. 시스템 호출을 사용한 경우 : 자발적
2. 인터럽트를 발생시킨 경우 : 비자발적